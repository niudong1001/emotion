var deleteUrl="http://115.159.145.109/emotion/php/picDelete.php"
angular.module('details', ['ionic'])
.controller('detailsCtrl', function($http,$scope, $ionicModal,$ionicPopup,$rootScope,$timeout,$ionicBackdrop) {
	$scope.src=localStorage.src;
	$scope.time=localStorage.time;
	$scope.tips=localStorage.tips;
	$scope.rate=localStorage.rate;

	$scope.willDelete=false;
	$scope.isDelete=false;
	$rootScope.isBack=false;
	$rootScope.alertNow=false;
	$scope.delete=function(){//删除该项
		$rootScope.prompt("警告操作","您确定要删除本项吗?",0);
		$scope.willDelete=true;
	}
	$rootScope.prompt=function(text,subText,flag){
     	$rootScope.proAni="prompt";
		$rootScope.isBack=true;
     	$rootScope.proTitle=text;
     	$rootScope.proText=subText;
     	$rootScope.alertNow=true;
     }
     $rootScope.ensure=function(){
     	$scope.drop();
     	if($scope.willDelete==true)
     		$scope.deleteDeal();
     }
     $scope.drop=function(){
     	$rootScope.proAni="pro-cancel";
     	$timeout(function(){
     		$rootScope.isBack=false;
     		$rootScope.alertNow=false;
     	},800);
     }
     $scope.deleteDeal=function(){
     	if($scope.isDelete==false){
     		//alert(localStorage.src);
	     	$http.get(deleteUrl+"?id="+localStorage.id).success(function(res){
	     		//alert(res);
	     			$rootScope.prompt("成功操作","删除成功",0);
	     			$scope.isDelete=true;
	     			$scope.willDelete=false;
	     			$timeout(function(){
	     				window.location.href="showPic.html";
	     			},1000);
	     	});
     	}
     }
});